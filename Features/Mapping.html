<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Mapping | rlist Tutorial</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="../Features/Filtering.html" />
    
    
    <link rel="prev" href="../Features/index.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-katex/katex.min.css">
        
    
    

        
    <div class="book" data-level="2.1" data-basepath=".." data-revision="Sun Mar 29 2015 09:39:24 GMT+0800 (China Standard Time)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="Getting-started/index.html">
            
                
                    <a href="../Getting-started/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Getting started
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="Getting-started/Quick-overview.html">
            
                
                    <a href="../Getting-started/Quick-overview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Quick overview
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Getting-started/Working-in-pipeline.html">
            
                
                    <a href="../Getting-started/Working-in-pipeline.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Working in pipeline
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Getting-started/File-formats.html">
            
                
                    <a href="../Getting-started/File-formats.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        File formats
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="Features/index.html">
            
                
                    <a href="../Features/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Features
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="2.1" data-path="Features/Mapping.html">
            
                
                    <a href="../Features/Mapping.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Mapping
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="Features/Filtering.html">
            
                
                    <a href="../Features/Filtering.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Filtering
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="Features/Updating.html">
            
                
                    <a href="../Features/Updating.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Updating
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="Features/Sorting.html">
            
                
                    <a href="../Features/Sorting.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Sorting
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="Features/Grouping.html">
            
                
                    <a href="../Features/Grouping.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        Grouping
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="Features/Joining.html">
            
                
                    <a href="../Features/Joining.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        Joining
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="Features/Searching.html">
            
                
                    <a href="../Features/Searching.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        Searching
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="Features/Comparers.html">
            
                
                    <a href="../Features/Comparers.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        Comparers
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.9" data-path="Features/Input-output.html">
            
                
                    <a href="../Features/Input-output.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.9.</b>
                        
                        Input/Output
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.10" data-path="Features/Misc-functions.html">
            
                
                    <a href="../Features/Misc-functions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.10.</b>
                        
                        Misc functions
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.11" data-path="Features/Lambda-expression.html">
            
                
                    <a href="../Features/Lambda-expression.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.11.</b>
                        
                        Lambda expression
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2.12" data-path="Features/List-environment.html">
            
                
                    <a href="../Features/List-environment.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.12.</b>
                        
                        List environment
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="Examples/index.html">
            
                
                    <a href="../Examples/index.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Examples
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="Examples/GitHub-API.html">
            
                
                    <a href="../Examples/GitHub-API.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        GitHub API
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="Examples/Weather-API.html">
            
                
                    <a href="../Examples/Weather-API.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Weather API
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">Published with GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Share on Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Share on Google</button>
                <button type="button" data-sharing="facebook" class="button">Share on Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Share on Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Share on Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >rlist Tutorial</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="mapping">Mapping</h1>
<p>Suppose we load the <a href="../data/sample.json">data</a> which is represented by the following table:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Age</th>
<th>Interests</th>
<th>Expertise</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ken</td>
<td>24</td>
<td>reading, music, movies</td>
<td>R:2, C#:4, Python:3</td>
</tr>
<tr>
<td>James</td>
<td>25</td>
<td>sports, music</td>
<td>R:3, Java:2, C++:5</td>
</tr>
<tr>
<td>Penny</td>
<td>24</td>
<td>movies, reading</td>
<td>R:1, C++:4, Python:2</td>
</tr>
</tbody>
</table>
<p><code>list.load()</code> is designed for loading data from given data source. The data source can be either local or remote and the function by default uses the file extension to decide the way to read it.</p>
<pre><code class="lang-r"><span class="hljs-keyword">library</span>(rlist)
people &lt;- list.load(<span class="hljs-string">&quot;http://renkun.me/rlist-tutorial/data/sample.json&quot;</span>)
str(people)
</code></pre>
<pre><code># List of 3
#  $ :List of 4
#   ..$ Name     : chr &quot;Ken&quot;
#   ..$ Age      : int 24
#   ..$ Interests: chr [1:3] &quot;reading&quot; &quot;music&quot; &quot;movies&quot;
#   ..$ Expertise:List of 3
#   .. ..$ R     : int 2
#   .. ..$ CSharp: int 4
#   .. ..$ Python: int 3
#  $ :List of 4
#   ..$ Name     : chr &quot;James&quot;
#   ..$ Age      : int 25
#   ..$ Interests: chr [1:2] &quot;sports&quot; &quot;music&quot;
#   ..$ Expertise:List of 3
#   .. ..$ R   : int 3
#   .. ..$ Java: int 2
#   .. ..$ Cpp : int 5
#  $ :List of 4
#   ..$ Name     : chr &quot;Penny&quot;
#   ..$ Age      : int 24
#   ..$ Interests: chr [1:2] &quot;movies&quot; &quot;reading&quot;
#   ..$ Expertise:List of 3
#   .. ..$ R     : int 1
#   .. ..$ Cpp   : int 4
#   .. ..$ Python: int 2
</code></pre><blockquote>
<p>NOTE: <code>str()</code> previews the structure of an object. We may use this function more often to avoid verbose representation of list objects.</p>
</blockquote>
<p>To extract the name of each people (list element), traditionally we can call <code>lapply()</code> like the following:</p>
<pre><code class="lang-r">lapply(people, <span class="hljs-keyword">function</span>(x) {
  x$Name
})
</code></pre>
<pre><code># [[1]]
# [1] &quot;Ken&quot;
# 
# [[2]]
# [1] &quot;James&quot;
# 
# [[3]]
# [1] &quot;Penny&quot;
</code></pre><p>Using rlist&apos;s <code>list.map()</code> the task is made extremely easy:</p>
<pre><code class="lang-r">list.map(people, Name)
</code></pre>
<pre><code># [[1]]
# [1] &quot;Ken&quot;
# 
# [[2]]
# [1] &quot;James&quot;
# 
# [[3]]
# [1] &quot;Penny&quot;
</code></pre><p>List mapping is to evaluate an expression for each list member. It is the fundamental operation in rlist functionality. Almost all functions in this package that work with expressions are using mapping but in different ways. The following examples demonstrate several types of mapping in more details.</p>
<h2 id="list-map">list.map</h2>
<p>The simplest way of mapping is provided by <code>list.map()</code> as we have just demonstrated. Basically, it evaluates an expression for each list element. </p>
<p>The function makes it easier to query a list by putting all fields of the list member in mapping to the environment where the expression is evaluated. In other words, the expression is evaluated in the context of one list member each time.</p>
<p>For example, the following code maps each list member in <code>people</code> by expression <code>age</code>. Therefore, it results in a list where each item becomes the value of that expression for each member of <code>people</code>.</p>
<pre><code class="lang-r">list.map(people, Age)
</code></pre>
<pre><code># [[1]]
# [1] 24
# 
# [[2]]
# [1] 25
# 
# [[3]]
# [1] 24
</code></pre><p>Since the expression does not have to be a field name of the list member, we can evaluate whatever we want in the context of a list member.</p>
<p>The following code maps each list member to the sum of years of the programming languages they use.</p>
<pre><code class="lang-r">list.map(people, sum(as.numeric(Expertise)))
</code></pre>
<pre><code># [[1]]
# [1] 9
# 
# [[2]]
# [1] 10
# 
# [[3]]
# [1] 7
</code></pre><p>If we need more than one values for each member, we can evaluate a vector or list expression.</p>
<p>The following code maps each list member to a new list of the age and range of number of years using programming languages.</p>
<pre><code class="lang-r">list.map(people, list(age=Age, range=range(as.numeric(Expertise))))
</code></pre>
<pre><code># [[1]]
# [[1]]$age
# [1] 24
# 
# [[1]]$range
# [1] 2 4
# 
# 
# [[2]]
# [[2]]$age
# [1] 25
# 
# [[2]]$range
# [1] 2 5
# 
# 
# [[3]]
# [[3]]$age
# [1] 24
# 
# [[3]]$range
# [1] 1 4
</code></pre><p>In some cases we need to refer to the item itself, or its index in the list, or even its name. In the expression, <code>.</code> represents the item itself, <code>.i</code> represents its index, and <code>.name</code> represents its name.</p>
<p>For example,</p>
<pre><code class="lang-r">nums &lt;- c(a=<span class="hljs-number">3</span>, b=<span class="hljs-number">2</span>, c=<span class="hljs-number">1</span>)
list.map(nums, . + <span class="hljs-number">1</span>)
</code></pre>
<pre><code># $a
# [1] 4
# 
# $b
# [1] 3
# 
# $c
# [1] 2
</code></pre><pre><code class="lang-r">list.map(nums, .i)
</code></pre>
<pre><code># $a
# [1] 1
# 
# $b
# [1] 2
# 
# $c
# [1] 3
</code></pre><pre><code class="lang-r">list.map(nums, paste0(<span class="hljs-string">&quot;name: &quot;</span>, .name))
</code></pre>
<pre><code># $a
# [1] &quot;name: a&quot;
# 
# $b
# [1] &quot;name: b&quot;
# 
# $c
# [1] &quot;name: c&quot;
</code></pre><p>If the default symbols clash with the data, we can use lambda expression to specify other symbols. We will cover this later.</p>
<blockquote>
<p>NOTE: rlist functions are general enough to work smoothly with vectors. <code>list.map()</code> works very much like <code>lapply()</code> so that the input will be finally transformed to list.</p>
</blockquote>
<h2 id="list-mapv">list.mapv</h2>
<p>If we want to get the mapping results as a vector rather than a list, we can use <code>list.mapv()</code>, which basically calls <code>unlist()</code> to the list resulted from <code>list.map()</code>.</p>
<pre><code class="lang-r">list.mapv(people, Age)
</code></pre>
<pre><code># [1] 24 25 24
</code></pre><pre><code class="lang-r">list.mapv(people, sum(as.numeric(Expertise)))
</code></pre>
<pre><code># [1]  9 10  7
</code></pre><h2 id="list-select">list.select</h2>
<p>In contrast to <code>list.map()</code>, <code>list.select()</code> provides an easier way to map each list member to a new list. This functions basically evaluates all given expressions and put the results into a list.</p>
<p>If a field name a list member is selected, its name will automatically preserved. If a list item evaluated from other expression is selected, we may better give it a name, or otherwise it will only have an index.</p>
<pre><code class="lang-r">list.select(people, Name, Age)
</code></pre>
<pre><code># [[1]]
# [[1]]$Name
# [1] &quot;Ken&quot;
# 
# [[1]]$Age
# [1] 24
# 
# 
# [[2]]
# [[2]]$Name
# [1] &quot;James&quot;
# 
# [[2]]$Age
# [1] 25
# 
# 
# [[3]]
# [[3]]$Name
# [1] &quot;Penny&quot;
# 
# [[3]]$Age
# [1] 24
</code></pre><pre><code class="lang-r">list.select(people, Name, Age, nlang=length(Expertise))
</code></pre>
<pre><code># [[1]]
# [[1]]$Name
# [1] &quot;Ken&quot;
# 
# [[1]]$Age
# [1] 24
# 
# [[1]]$nlang
# [1] 3
# 
# 
# [[2]]
# [[2]]$Name
# [1] &quot;James&quot;
# 
# [[2]]$Age
# [1] 25
# 
# [[2]]$nlang
# [1] 3
# 
# 
# [[3]]
# [[3]]$Name
# [1] &quot;Penny&quot;
# 
# [[3]]$Age
# [1] 24
# 
# [[3]]$nlang
# [1] 3
</code></pre><h2 id="list-iter">list.iter</h2>
<p>Sometimes we don&apos;t really need the result of a mapping but its side effects. For example, if we only need to print out something about each list member, we don&apos;t need to carry on the output of mapping.</p>
<p><code>list.iter()</code> performs iterations over a list and returns the input data invisibly for further data transformation.</p>
<pre><code class="lang-r">list.iter(people, cat(Name, <span class="hljs-string">&quot;:&quot;</span>, Age, <span class="hljs-string">&quot;\n&quot;</span>))
</code></pre>
<pre><code># Ken : 24 
# James : 25 
# Penny : 24
</code></pre><h2 id="list-maps">list.maps</h2>
<p>All the previous functions work with a single list. However, there are scenarios where mapping multiple lists is needed. <code>list.maps()</code> evaluates an expression with multiple lists each of which is represented by a user-defined symbol at the function call.</p>
<pre><code class="lang-r">l1 &lt;- list(p1=list(x=<span class="hljs-number">1</span>,y=<span class="hljs-number">2</span>), p2=list(x=<span class="hljs-number">3</span>,y=<span class="hljs-number">4</span>), p3=list(x=<span class="hljs-number">1</span>,y=<span class="hljs-number">3</span>))
l2 &lt;- list(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>)
list.maps(a$x*b+a$y, a=l1, b=l2)
</code></pre>
<pre><code># $p1
# [1] 4
# 
# $p2
# [1] 13
# 
# $p3
# [1] 8
</code></pre><p><code>list.maps()</code> does not follow the conventions of many other functions like <code>list.map()</code> and <code>list.iter()</code> where the data comes first and expression comes the second. Since <code>list.maps()</code> supports multi-mapping with a group of lists, only implicit lambda expression is supported to avoid ambiguity. After that the function still allows users to define the symbol that represents each list being mapped in <code>...</code>.</p>
<p>In the example above, <code>...</code> means <code>a = l1, b = l2</code>, so that <code>a</code> and <code>b</code> are meaningful in the first expression <code>a$x*b+a$y</code> where <code>a</code> and <code>b</code> mean the iterating element of each list, respectively.</p>
<p>The function does not require named be supplied with the lists as arguments. In this case, we can use <code>..1</code>, <code>..2</code>, etc. to refer to the first, second or other lists.</p>
<pre><code class="lang-r">list.maps(..1$x*..2 + ..1$y, l1, l2)
</code></pre>
<pre><code># $p1
# [1] 4
# 
# $p2
# [1] 13
# 
# $p3
# [1] 8
</code></pre>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../Features/index.html" class="navigation navigation-prev " aria-label="Previous page: Features"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../Features/Filtering.html" class="navigation navigation-next " aria-label="Next page: Filtering"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-ga/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"ga":{"token":"UA-47159422-1","configuration":"auto"}};
    gitbook.start(config);
});
</script>

        <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-47159422-1', 'auto');ga('send', 'pageview');</script>
    </body>
    
</html>
